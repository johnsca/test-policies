policies:
  - name: user-login-detected
    resource: account
    description: |
      Notifies Security and Cloud Admins teams on any AWS root user console logins
    mode:
       type: cloudtrail
       events:
          - ConsoleLogin
    actions:
      - type: notify
        template: slack.html
        priority_header: 1
        violation_desc: "A User Has Logged Into the AWS Console"
        action_desc: |
            Please investigate and if needed revoke the root users session along
            with any other restrictive actions if it's an unapproved root login
        to:
          - slack://event-owner
        transport:
          type: sqs
          queue: arn:aws:sqs:us-east-2:880584957794:dev-stacklet-commshub-messages
